---

  ESP32-C3 边缘 AI 文件服务器与异常检测系统 - 使用说明书

  1. 项目简介

  本项目基于 ESP32-C3 芯片，集成了 Edge Impulse
  机器学习模型，用于实时模拟工业设备的异常检测（压缩机与涡轮机健康度预测）。同时，设备作为 Wi-Fi SoftAP (热点) 运行，提供
  HTTP 文件服务器功能，允许用户通过浏览器管理设备内部存储的文件。

  核心功能：
   * 边缘 AI 推理：集成 TFLite 模型，实时计算压缩机和涡轮机的衰减系数。
   * 异常报警：当健康度低于预设阈值时，触发蜂鸣器报警并在屏幕显示 "ERR"。
   * 状态显示：通过 OLED 屏幕实时显示 Wi-Fi 信息、IP 地址及 AI 推理结果。
   * 文件服务：支持通过 Wi-Fi 上传/下载文件到设备内部 SPIFFS 存储系统。

---

  2. 硬件连接说明

  请按照以下引脚定义连接您的硬件外设：

  ┌─────────────────┬──────────┬──────────────────────┬────────────────────────────┐
  │ 外设名称        │ 硬件接口 │ ESP32-C3 引脚 (GPIO) │ 说明                       │
  ├─────────────────┼──────────┼──────────────────────┼────────────────────────────┤
  │ OLED 显示屏     │ I2C SDA  │ GPIO 3               │ SSD1306 驱动 (128x64)      │
  │                 │ I2C SCL  │ GPIO 4               │                            │
  │                 │ VCC/GND  │ 3.3V / GND           │                            │
  │ 蜂鸣器 (Buzzer) │ 信号脚   │ GPIO 5               │ 高电平触发 (有源) │
  │                 │ VCC/GND  │ 3.3V / GND           │                            │
  └─────────────────┴──────────┴──────────────────────┴────────────────────────────┘

---

  3. 固件烧录指南

  方法 A：使用 ESP-IDF 开发环境
  如果您已配置好 ESP-IDF 环境，请在项目根目录下执行以下命令：

   1. 设置目标芯片：
      1     idf.py set-target esp32c3
   2. 编译、烧录并打开监视器：
      1     # 替换 /dev/ttyUSB0 为您的实际串口号 (Windows下为 COMx)
      2     idf.py -p /dev/ttyUSB0 build flash monitor

  方法 B：使用 Flash 下载工具  (推荐)
  如果您只有编译好的二进制文件 (.bin)，可以使用乐鑫官方 Flash Download Tool  进行烧录。

  内存地址映射表 (Partition Map)：

  ┌─────────────────────┬───────────────────┬───────────────────────┐
  │ 文件名 (示例)       │ 烧录地址 (Offset) │ 描述                  │
  ├─────────────────────┼───────────────────┼───────────────────────┤
  │ bootloader.bin      │ 0x0000            │ 启动引导程序          │
  │ partition-table.bin │ 0x8000            │ 分区表                │
  │ file_serving.bin    │ 0x10000           │ 主应用程序固件        │
  └─────────────────────┴───────────────────┴───────────────────────┘

---

  4. 操作说明

  4.1 启动与 Wi-Fi 连接
  设备上电后，会自动启动 Wi-Fi 热点模式。

   1. 搜索 Wi-Fi：使用手机或电脑搜索附近的 Wi-Fi 信号。
   2. 连接热点：
       * SSID (名称): ESP32-Anomaly
       * Password (密码): 12345678
   3. 连接成功：连接后，设备 OLED 屏幕上的 IP 地址一栏将从 "Wait IP..." 更新为分配的网关地址（通常为 192.168.4.1）。

  4.2 访问文件服务器
   1. 打开浏览器 (Chrome/Edge/Safari)。
   2. 在地址栏输入设备的 IP 地址：http://192.168.4.1。

  4.3 观察 AI 异常检测
  设备会循环运行内置的推理测试用例。请观察 OLED 屏幕：

   * C: (Compressor/压缩机): 显示当前预测的衰减值。
       * 如果数值 < 0.950，显示 ERR，蜂鸣器鸣叫。
       * 否则显示 OK。
   * T: (Turbine/涡轮机): 显示当前预测的衰减值。
       * 如果数值 < 0.975，显示 ERR，蜂鸣器鸣叫。
       * 否则显示 OK。
   * Th: (Threshold/阈值): 屏幕底部显示当前的判断阈值供参考。

---

  5. 常见问题排查 (FAQ)

  Q1: 屏幕不亮？
   * 检查 VCC 是否接在 3.3V。
   * 检查 SDA 是否接 GPIO 3，SCL 是否接 GPIO 4。

---

  6. 技术参数

   * 主控: ESP32-C3-MINI-1 (RISC-V 单核 160MHz)
   * 供电: 5V (USB) 或 3.3V (Pin)
   * Flash: 4MB (默认配置)
   * 分区表: Custom (partitions_example.csv)
   * 文件系统: SPIFFS
   * 开发框架: ESP-IDF v5.4